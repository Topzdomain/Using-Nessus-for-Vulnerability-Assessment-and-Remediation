<h2 align="center"> SETTING UP NESSUS SCANNER ON AWS</h2>

Nessus is a remote security scanning tool, which scans a target computer and raises an alert if it discovers any vulnerabilities that malicious hackers could use to gain access to the computer that has been connected to a network.  It does this by running over 1200 checks on the target computer, testing to see if any of these attacks could be used to break into the computer or otherwise harm it. 
Nessus works by testing each port on a computer, determining what service it is running, and then testing this service to make sure there are no vulnerabilities in it that could be used by a hacker to carry out a malicious attack.
Nessus can scan these vulnerabilities and exposures:

<p4 align="left"> 
Vulnerabilities that could allow unauthorized control or access to sensitive data on a system
</p4>
<h4 align="left"> 
✔️ Misconfiguration (e.g. open mail relay)
</h4>
<h4 align="left"> 
✔️ Denials of service (DOS) vulnerabilities
</h4>
<h4 align="left"> 
✔️ Default passwords, a few common passwords, and blank/absent passwords on some system accounts
</h4>

Before I started the Installation process and creating an EC2 instance, I signed up for the Nessus Expert Free trial, which was for 7 days, after which I launched the EC2 instance. I used the following configurations: Ubuntu Server AMI, a t2.xlarge instance with 4 vCPU and 16 GiB Memory, and a 25 GiB gp2 Root volume. I had previously created a security group and key pairs which were used during the EC2 instance launch.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/ec2-instance-cration1.png" height="40%" width="60%"/>
</p>

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/ec2-instance-cration2.png" height="40%" width="60%"/>
</p>

Next, I downloaded the Nessus execution file for Ubuntu using the curl command. Before copying the command, I ensured I picked the right installation platform.

```commandline
curl --request GET \
  --url 'https://www.tenable.com/downloads/api/v2/pages/nessus/files/Nessus-10.7.2-ubuntu1404_amd64.deb' \
  --output 'Nessus-10.7.2-ubuntu1404_amd64.deb'
```

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/Nessus-download.png" height="60%" width="50%"/>
</p>

Installed the downloaded file

```commandline
sudo dpkg -i Nessus-10.7.2-ubuntu1404_amd64.deb
```

Then started the Nessusd service

```commandline
sudo systemctl start nessusd
```
I had already configured the security group to open ports 8834, 8835, UDP 58, 1243, and 443. So I launched the configuration of the web installer by entering the EC2's public IP address and the required 8834 in a browser.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/web-installer2.png" height="45%" width="30%"/>
</p>

After the installation was completed, the Nessus administration dashboard opened and I was ready to begin my scans. It also took some time for the Nessus core component, license and plugins to complete downloading.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/administration-dashboard.png" height="85%" width="75%"/>
</p>

<h3 align="left"> Carrying Out Basic Network Scan</h3>

Before carrying out the network scan, I did a host discovery scan of my host device IP address, after which I did the basic network scan of the discovered host (my Windows machine), which returned some issues. The host discovery scan aside from detecting the host IP, also discovered some open ports on the Windows machine and flagged two (2) vulnerabilities. The vulnerabilities were just info and so did not need much attention.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/host-discovery-scan.png" height="45%" width="55%"/>
</p>

The basic network scan returned some medium vulnerabilities around the Server Message Block(SMB) Protocol running on port 445 and the "SSL Certificate Cannot Be Trusted" issue, while others were just information.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/Basic-network-scan.png" height="55%" width="45%"/>
</p>

<h3 align="left"> Remediation of Flagged Issues</h3>

One of the issues flagged by the scan was a medium-level Server Message Block (SMB) signing vulnerability. The scan produces a description of the problem and also offers a solution. In the case of the SMB signing-in issue, the problem is that the server is not enforcing message signing for SMB communication and attackers could take advantage of the vulnerability to perform a Man-In-The-Middle (MITM) attack on the server and eavesdrop on the communication between the client and server or perform other post-exploitation attacks. 

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/smb%20signin%20resolution.png" height="55%" width="45%"/>
</p>

To resolve this issue, On the security options of the local group policy editor, I set to "Enabled" "Microsoft network client: Digitally sign communications (always)" and Microsoft network server: Digitally sign communications (always)", then restart the machine.

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/remediating-smb-issue.png" height="55%" width="45%"/>
</p>

<h3 align="left"> Further Activities</h3>

I also installed the Nessus scanner on my Windows device and used it to scan Owasp Juice Shop (a modern and sophisticated insecure web application which can be used as a guinea pig for security tools), a Windows 11 device on my network. After the scan was done, I worked on remediating the medium and high-level vulnerabilities that were flagged. Some of the vulnerabilities flagged and remediated include TLS 1.1 vulnerability (High) which needs to be disabled and TLS 1.2 and/or 1.3 enabled, Microsoft SMB Shares Unpriviledged Access (High) and SMB digital Signature not enabled vulnerability (Medium). 

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/basic-scan-of-another-windows-device.png" height="55%" width="70%"/>
</p>
<h5 align="center"> scan result of my other windows machine</h5>

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/multiple-issue-flagging1.png" height="55%" width="70%"/>
</p>
<h5 align="center"> High vulnerability unpriviledged access issue flagged for remediation</h5>

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/multiple-issue-flagging2.png" height="55%" width="70%"/>
</p>
<h5 align="center"> High vulnerability medium encryption strenght issue flagged for remediation</h5>

<p align="center">
<img src="https://github.com/Topzdomain/Using-Nessus-for-Vulnerability-Assessment-and-Remediation/blob/main/screenshots/scan-result-after-all-remediation.png" height="55%" width="70%"/>
</p>
<h5 align="center"> scan result after all remediations on the Windows machine</h5>
